(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{423:function(s,a,t){"use strict";t.r(a);var e=t(21),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"一、实用技巧"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、实用技巧"}},[s._v("#")]),s._v(" 一、实用技巧")]),s._v(" "),t("h3",{attrs:{id:"_1-命令自动补全"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-命令自动补全"}},[s._v("#")]),s._v(" 1. 命令自动补全")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#安装")]),s._v("\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y bash-completion \n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /usr/share/bash-completion/bash_comletion\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("kubectl completion "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#生效")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"source <(kubectl completion bash)"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" ~/.bashrc "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#永久化")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h3",{attrs:{id:"_2-查看-k8s-资源缩写"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-查看-k8s-资源缩写"}},[s._v("#")]),s._v(" 2. 查看 k8s 资源缩写")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("kubectl api-resources\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"_3-获取某字段下的属性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-获取某字段下的属性"}},[s._v("#")]),s._v(" 3. 获取某字段下的属性")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("kubectl explain pod.spec.affinity "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#以 affinity 为例")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"_4-快速生成-yaml-模板"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-快速生成-yaml-模板"}},[s._v("#")]),s._v(" 4. 快速生成 yaml 模板")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("kubectl run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("deploy_name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" --image"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx -o yaml --dry-run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" xxx.yaml "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#通过 run 生成deploy模板（ --dry-run 不会真的创建 deploy）")]),s._v("\n\nkubectl get "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("resourcename"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -o"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yaml "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" xxx.yaml "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#通过现有资源生成 yaml 模板")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h2",{attrs:{id:"二、日常使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、日常使用"}},[s._v("#")]),s._v(" 二、日常使用")]),s._v(" "),t("h3",{attrs:{id:"_1-查看"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-查看"}},[s._v("#")]),s._v(" 1. 查看")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("kubectl cluster-info "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看集群")]),s._v("\nkubectl cluster-info dump "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看集群具体信息")]),s._v("\n\nkubectl get cs "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看master组件状态")]),s._v("\n\nkubectl get "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("resource_name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -o wide "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看具体资源对象")]),s._v("\nkubectl get "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("resource_name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -o yaml "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看对象的 yaml 信息")]),s._v("\nkubectl describe "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("resource_name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看对象的详细信息")]),s._v("\n\nkubectl logs -f "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("pod-name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -c "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("container-name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看日志")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("h3",{attrs:{id:"_2-操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-操作"}},[s._v("#")]),s._v(" 2. 操作")]),s._v(" "),t("h4",{attrs:{id:"普通操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#普通操作"}},[s._v("#")]),s._v(" 普通操作")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("kubectl apply -f xxx.yaml "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#根据文件创建对象")]),s._v("\n\nkubectl edit "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("resource_name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#编辑对象")]),s._v("\n\nkubectl delete -f xxx.yaml "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#根据文件删除对象")]),s._v("\nkubectl delete "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("resource_name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除对象")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h4",{attrs:{id:"deployment滚动升级"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#deployment滚动升级"}},[s._v("#")]),s._v(" deployment滚动升级")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("kubectl run nginx-deploy --image"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx --replicas"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建 deploy")]),s._v("\n\nkubectl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" image deploy nginx-deploy nginx-deploy"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx:1.9.1 "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#升级 image")]),s._v("\nkubectl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" resources deploy nginx-deploy -c"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx --limits"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("cpu"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("200m,memory"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("512Mi "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#升级资源")]),s._v("\n\nkubectl rollout pause deploy nginx-deploy "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#暂停 deploy")]),s._v("\n\nkubectl rollout resume deploy nginx-deploy "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#恢复 deploy")]),s._v("\n\nkubectl rollout status deploy nginx-deploy "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查询升级状态")]),s._v("\n\nkubectl rollout "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v(" deploy nginx-deploy "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查询升级历史")]),s._v("\nkubectl rollout "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v(" deploy nginx-deploy --revision"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看指定版本历史")]),s._v("\n\nkubectl rollout undo deploy nginx-deploy --to-revision"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#回滚")]),s._v("\n\nkubectl scale deploy nginx-deploy --replicas"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#弹性伸缩")]),s._v("\n\nkubectl autoscale deploy nginx-deploy --min"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" --max"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" --cpu-percent"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#弹性伸缩")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("h4",{attrs:{id:"创建service"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建service"}},[s._v("#")]),s._v(" 创建service")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("kubectl create "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" --tcp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(":8080 "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#type:clusterip、nodeport")]),s._v("\n\nkubectl create "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" clusterip "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" --clusterip"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"None"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#headless service")]),s._v("\n\nkubectl expose deploy "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("deploy_name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" --type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ClusterIP --name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" --port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" --target-port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#expose deployment")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])])])}),[],!1,null,null,null);a.default=r.exports}}]);