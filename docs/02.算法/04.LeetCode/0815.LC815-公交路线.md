---
title: LC815-å…¬äº¤è·¯çº¿
date: 2021-06-28 19:10:59
permalink: /pages/3e65f3/
---

## é¢˜ç›®æè¿°

- é“¾æ¥ï¼š[https://leetcode-cn.com/problems/bus-routes/](https://leetcode-cn.com/problems/bus-routes/)
- éš¾åº¦ï¼šğŸ”´
- æ ‡ç­¾ï¼š[BFS](/pages/c635ec/)ã€[å“ˆå¸Œè¡¨](/pages/dee52c/)

## è§£é¢˜æ€è·¯
### æ–¹æ³•ä¸€ï¼šå•å‘BFS
æ­¤é¢˜åŒç†äºï¼š
- [LC752-æ‰“å¼€è½¬ç›˜é”](/pages/8e87e0/)

æ¯ä¸ªç»“ç‚¹éƒ½æœ‰ç›¸åº”çš„å‡ ä¸ªå¯è¾¾ç‚¹ä¸”æ±‚è§£æœ€å°‘æ¢ä¹˜æ¬¡æ•°ï¼Œå› æ­¤å¯ç›´æ¥å¥—ç”¨[å•å‘BFS](/pages/c635ec/#å•å‘bfs)çš„æ¨¡æ¿ï¼ŒåŒæ—¶æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š
1. ä¸ºäº†å¿«é€Ÿå¯»æ‰¾å½“å‰è½¦ç«™æ‰€ç»è¿‡çš„æ‰€æœ‰å…¬äº¤è·¯çº¿ï¼Œå¯ä»¥ä½¿ç”¨`unordered_map`å»ºç«‹è½¦ç«™ä¸ç»è¿‡çš„æ‰€æœ‰å…¬äº¤è·¯çº¿çš„æ˜ å°„
2. å¯ä»¥å¾—çŸ¥ä¸€æ¡å·²è®¿é—®è¿‡çš„å…¬äº¤è·¯çº¿ä¸Šçš„è½¦ç«™è‚¯å®šä¹Ÿè®¿é—®è¿‡ï¼Œå› æ­¤å¯ä½¿ç”¨ä¸€ä¸ªboolå‹æ•°ç»„visitedæ¥è®°å½•æŸä¸ªå…¬äº¤è·¯çº¿æ˜¯å¦å·²è¢«è®¿é—®
3. è½¦ç«™çš„æ•°å€¼èŒƒå›´è¾ƒå¤šï¼Œæ•…ä½¿ç”¨`unordered_set`æ¥è®°å½•è½¦ç«™æ˜¯å¦å·²å…¥è¿‡é˜Ÿ

ä»£ç å®ç°ï¼š

<code-group>
<code-block title="C++" active>
```cpp
class Solution {
public:
    int numBusesToDestination(vector<vector<int>>& routes, int source, int target) {
        unordered_map<int, vector<int>> map;  // è®°å½•æ¯ä¸ªè½¦ç«™å¯ä»¥ä¹˜åçš„æ‰€æœ‰å…¬äº¤è·¯çº¿
        for(int i = 0; i < routes.size(); ++i) {
            for(int j = 0; j < routes[i].size(); ++j) map[routes[i][j]].push_back(i);
        }
        vector<bool> visited(routes.size(), false);  // è®°å½•æŸæ¡å…¬äº¤è·¯çº¿æ˜¯å¦å·²è®¿é—®
        unordered_set<int> inq;  // è®°å½•æŸè½¦ç«™æ˜¯å¦å·²å…¥è¿‡é˜Ÿ
        return BFS(source, target, routes, map, visited, inq);
    }
    // å•å‘BFS
    int BFS(int start, int target, vector<vector<int>>& routes, unordered_map<int, vector<int>>& map, vector<bool>& visited, unordered_set<int>& inq) {
        int res = 0;
        queue<int> q;
        q.push(start);
        inq.insert(start);
        while(!q.empty()) {
            for(int i = 0, len = q.size(); i < len; ++i) {
                if(q.front() == target) return res;
                vector<int> nexts = getNexts(q.front(), routes, map, visited, inq);
                q.pop();
                for(int j = 0; j < nexts.size(); ++j) {
                    q.push(nexts[j]);
                    inq.insert(nexts[j]);
                }
            }
            ++res;
        }
        return -1;
    }
    // è·å–å½“å‰è½¦ç«™å¯ä»¥åˆ°è¾¾çš„å…¶å®ƒè½¦ç«™ï¼ˆä¸”æœªæ›¾å…¥é˜Ÿï¼‰
    vector<int> getNexts(int node, vector<vector<int>>& routes, unordered_map<int, vector<int>>& map, vector<bool>& visited, unordered_set<int>& inq) {
        vector<int> res;
        for(int i = 0; i < map[node].size(); ++i) {  // å½“å‰è½¦ç«™å¯ä»¥ä¹˜åçš„æ‰€æœ‰å…¬äº¤è·¯çº¿
            int route = map[node][i];
            if(!visited[route]) {
                for(int j = 0; j < routes[route].size(); ++j) {
                    if(inq.find(routes[route][j]) == inq.end()) res.push_back(routes[route][j]);
                }
                visited[route] = true;
            }
        }
        return res;
    }
};
```
</code-block>
</code-group>